{% extends "base.html" %}
{% load govuk_frontend_django %}
{% block title %}Manage user - {{ user.first_name }} {{ block.super }}{% endblock %}
{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            {% if form.errors %}
                <div class="govuk-error-summary" aria-labelledby="error-summary-title" role="alert" tabindex="-1"
                     data-module="govuk-error-summary">
                    <h2 class="govuk-error-summary__title" id="error-summary-title">
                        There is a problem
                    </h2>
                    <div class="govuk-error-summary__body">
                        <ul class="govuk-list govuk-error-summary__list">
                            {% for field in form %}
                                {% for error in field.errors %}
                                    <li><a href="#{{ field.name }}">{{ field.name }} : {{ error }}</a></li>
                                {% endfor %}
                            {% endfor %}
                            {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endif %}
            <span class="govuk-caption-l">{{ current_profile.organisation.name }}</span>
            {% if form.instance.id %}
                <h1 class="govuk-heading-l">Edit user</h1>
            {% else %}
                <h1 class="govuk-heading-l">Add a user</h1>
            {% endif %}

            <form class="form" method="post">
                {% csrf_token %}
                <div class="govuk-form-group">
                    <label class="govuk-label" for="system_name">
                        First name
                    </label>
                    <input class="govuk-input govuk-input--width-20" id="first_name" name="first_name" type="text"
                           spellcheck="false"
                           value="{{ form.first_name.value|default:'' }}">
                </div>
                <div class="govuk-form-group">
                    <label class="govuk-label" for="last_name">
                        Last name
                    </label>
                    <input class="govuk-input govuk-input--width-20" id="last_name" name="last_name" type="text"
                           spellcheck="false"
                           value="{{ form.last_name.value|default:'' }}">
                </div>
                <div class="govuk-form-group">
                    <label class="govuk-label" for="email">
                        Email address
                    </label>
                    <input class="govuk-input govuk-input--width-20" id="email" name="email" type="text"
                           spellcheck="false"
                           value="{{ form.email.value|default:'' }}">
                </div>
                <div class="govuk-form-group">
                    <h3 class="govuk-heading-m">
                        Select a user role
                    </h3>
                    <p class="govuk-hint">Select one that applies</p>
                    <div class="govuk-radios" data-module="govuk-radios">
                        <ul id="role" class="govuk-list">
                            {% for role in roles %}
                                <div class="govuk-radios__item">
                                    <input class="govuk-radios__input" id="role{{ forloop.counter }}"
                                           name="role"
                                           type="radio"
                                           {% if role.0 == form.role.value %}checked{% endif %}
                                           value="{{ role.0 }}">
                                    <label class="govuk-label govuk-radios__label" for="role{{ forloop.counter }}">
                                        {{ role.1 }}
                                    </label>
                                    <div id="userRole-item-hint" class="govuk-hint govuk-radios__hint">
                                        <details class="govuk-details govuk-!-margin-bottom-0">
                                            <summary class="govuk-details__summary">
                                            <span class="govuk-details__summary-text">
                                              What {{ role.1 }} can do
                                            </span>
                                            </summary>
                                            <div class="govuk-details__text">
                                                <ul class="govuk-list govuk-list--bullet">
                                                    {% for action_available in  role.2 %}
                                                        <li>{{ action_available }}</li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                        </details>
                                    </div>
                                </div>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                <div class="govuk-button-group">
                    <span class="govuk-body govuk-!-font-size-24">
                        <button type="submit" class="govuk-button" data-module="govuk-button">
                            Save and continue
                        </button>
                    </span>
                </div>
            </form>
        </div>
    </div>
{% endblock %}
